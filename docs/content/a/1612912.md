---
title: "[Q#1612808][A#1612912] How to remove the carriage return from string while pasting content to Excel file"
question_title: "How to remove the carriage return from string while pasting content to Excel file"
question_text: "I have a problem while pasting my contents (or text) generated by Java code into excel. The problem is that my Java code generates a String with multiple lines, i.e. with line breaks (\\n) included.  When I try to copy this content and paste it into an Excel file, I am getting a multiline text with a square box symbol.  I came to know that Windows uses \\r\\n for line breaks and not just \\n.  I tried to replace my \\n with \\r\\n and paste the generated text, but I am getting the same square boxes in my Excel file.  Here is my sample code: I have used the \" \" to wrap the text.  When I tried to paste tmpstring in Excel, I got the square box.  How can I remove the boxes with multiple lines in my cell?"
answer_text: "Do you want the carriage return / newline, or don't you? Your title says that you don't, your code is explicitly adding carriage returns when the string has a newline. If you want to get rid of both, use String.replaceAll(), which takes a regex: This example finds any occurrence of the characters, and deletes them. You probably want to look for the sequence of characters and replace with a space, but I'll leave that up to you: look at the doc for java.util.regex.Pattern. And I suspect that the \"box\" is some other character, not a return or newline."
apization_code: "package com.stackoverflow.api;  /**  * How to remove the carriage return from string while pasting content to Excel file  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/1612912\">https://stackoverflow.com/a/1612912</a>  */ public class APIzator1612912 {    public static String removeReturn(String s1) throws Exception {     String s2 = s1.replaceAll(\"[\\n\\r]\", \"\");     return s2;   } }"
---

https://stackoverflow.com/q/1612808

I have a problem while pasting my contents (or text) generated by Java code into excel.
The problem is that my Java code generates a String with multiple lines, i.e. with line breaks (\n) included.  When I try to copy this content and paste it into an Excel file, I am getting a multiline text with a square box symbol.  I came to know that Windows uses \r\n for line breaks and not just \n.  I tried to replace my \n with \r\n and paste the generated text, but I am getting the same square boxes in my Excel file.  Here is my sample code:
I have used the &quot; &quot; to wrap the text.  When I tried to paste tmpstring in Excel, I got the square box.  How can I remove the boxes with multiple lines in my cell?


<div class="code-logo"><img src="/stackoverflow.png" /></div>

```java
String   myString = "a1\nb1";
      String   tmpString =myString.replace("\n","\r\n");
      System.out.println( "Original = " +"\""+myString+"\"");
      System.out.println( "Result   = " +"\""+tmpString+"\"");
```


## Original code snippet

https://stackoverflow.com/a/1612912

Do you want the carriage return / newline, or don&#x27;t you? Your title says that you don&#x27;t, your code is explicitly adding carriage returns when the string has a newline. If you want to get rid of both, use String.replaceAll(), which takes a regex:
This example finds any occurrence of the characters, and deletes them. You probably want to look for the sequence of characters and replace with a space, but I&#x27;ll leave that up to you: look at the doc for java.util.regex.Pattern.
And I suspect that the &quot;box&quot; is some other character, not a return or newline.

<div class="code-logo"><img src="/stackoverflow.png" /></div>

```java
public static void main(String[] argv)
throws Exception
{
    String s1 = "this\r\nis a test";
    String s2 = s1.replaceAll("[\n\r]", "");
    System.out.println(s2);
}
```

## Produced APIzation

[`APIzator1612912.java`](https://github.com/pasqualesalza/apization/raw/main/data/search/APIzator1612912.java)

<div class="code-logo"><img src="/apizator.png" /></div>

```java
package com.stackoverflow.api;

/**
 * How to remove the carriage return from string while pasting content to Excel file
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/1612912">https://stackoverflow.com/a/1612912</a>
 */
public class APIzator1612912 {

  public static String removeReturn(String s1) throws Exception {
    String s2 = s1.replaceAll("[\n\r]", "");
    return s2;
  }
}

```